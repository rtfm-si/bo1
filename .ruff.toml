# Ruff configuration file
# See: https://docs.astral.sh/ruff/

line-length = 100
target-version = "py312"

[lint]
select = [
    "E",    # pycodestyle errors
    "W",    # pycodestyle warnings
    "F",    # pyflakes
    "I",    # isort
    "B",    # flake8-bugbear
    "C4",   # flake8-comprehensions
    "UP",   # pyupgrade
    "ANN",  # flake8-annotations
    "S",    # flake8-bandit (security)
    "N",    # pep8-naming
    "D",    # pydocstyle
]

ignore = [
    "E501",    # line too long (handled by formatter)
    "B008",    # do not perform function calls in argument defaults
    "D100",    # missing docstring in public module
    "D104",    # missing docstring in public package
    "D106",    # missing docstring in public nested class (Pydantic Config classes)
    "S101",    # use of assert detected (OK in tests)
    "ANN401",  # allow typing.Any in function signatures (needed for Pydantic validators, wrappers)
    "S608",    # SQL injection false positive for hardcoded table names in migrations
]

[lint.per-file-ignores]
"tests/**/*.py" = [
    "S101",    # assert allowed in tests
    "ANN",     # annotations optional in tests
    "D",       # docstrings optional in tests
]
"test_*.py" = [
    "S101",    # assert allowed in tests
    "ANN",     # annotations optional in tests
    "D",       # docstrings optional in tests
]
"scripts/*.py" = [
    "ANN",     # annotations optional in scripts
    "D103",    # docstrings optional in scripts
]
"migrations/versions/*.py" = [
    "D415",    # first line punctuation not needed in migration docstrings
]
# Re-exports at bottom of file after class definitions
"bo1/graph/state.py" = ["E402", "I001"]
"backend/api/context/routes.py" = ["E402", "I001"]
# Batch-generated service files - relax docstring/annotation requirements for internal dataclasses
"backend/services/dataset_comparator.py" = ["D102", "D107", "ANN204"]
"backend/services/deterministic_analyzer.py" = ["D102", "D107", "ANN204"]
"backend/services/duckdb_engine.py" = ["D102", "D107", "ANN204"]
"backend/services/multi_dataset_analyzer.py" = ["D102", "D107", "ANN204"]
"backend/services/pii_detector.py" = ["D102", "D107", "ANN204"]
"backend/services/dataset_report_generator.py" = ["D102", "D107", "ANN204"]

[lint.pydocstyle]
convention = "google"

[format]
quote-style = "double"
indent-style = "space"
skip-magic-trailing-comma = false
line-ending = "auto"
