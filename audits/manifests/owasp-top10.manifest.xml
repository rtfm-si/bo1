# OWASP Top 10 (2021) Security Audit Manifest

<audit_manifest>
  <audit_type>owasp-top10</audit_type>

  <purpose>
    Comprehensive security testing against OWASP Top 10 (2021) vulnerability categories
    to identify and remediate common web application security risks.
  </purpose>

  <scope>
    - All API endpoints (backend/api/*.py)
    - Authentication and authorization flows
    - Data handling and validation
    - Third-party integrations (OAuth, Sheets, LLM)
    - Infrastructure configuration
  </scope>

  <constraints>
    - Follow CLAUDE.md, GOVERNANCE, CONTEXT_BOUNDARY
    - Cross-reference existing audits (auth-security, infra-security, auth-pentest)
    - Document findings with severity (Critical/High/Medium/Low/Info)
    - Provide remediation steps for each finding
  </constraints>

  <required_inputs>
    - API route definitions
    - Authentication middleware
    - Database models and queries
    - External service integrations
    - Docker/infrastructure configuration
    - Existing security audit reports
  </required_inputs>

  <expected_outputs>
    - Findings per OWASP category
    - Severity classification
    - Remediation recommendations
    - Pass/fail status per test case
    - Final report: audits/reports/owasp-top10.report.md
  </expected_outputs>

  <test_categories>
    <category id="A01" name="Broken Access Control">
      - IDOR on sessions, datasets, actions, users
      - Privilege escalation (user to admin)
      - Missing function-level access control
      - CORS misconfiguration
    </category>
    <category id="A02" name="Cryptographic Failures">
      - Sensitive data exposure in responses
      - Weak/missing encryption (tokens, passwords)
      - Hardcoded secrets in codebase
      - TLS configuration
    </category>
    <category id="A03" name="Injection">
      - SQL injection (SQLAlchemy parameterization)
      - Command injection (subprocess calls)
      - NoSQL injection (Redis commands)
    </category>
    <category id="A04" name="Insecure Design">
      - Business logic flaws
      - Missing rate limiting on critical endpoints
      - Lack of input validation
    </category>
    <category id="A05" name="Security Misconfiguration">
      - Debug mode exposure
      - Default credentials
      - Unnecessary features enabled
      - Missing security headers
    </category>
    <category id="A06" name="Vulnerable Components">
      - Python dependencies (pip-audit)
      - npm dependencies (npm audit)
      - Known CVEs in stack
    </category>
    <category id="A07" name="Auth Failures">
      - Session fixation
      - Weak password policies
      - Credential stuffing protection
    </category>
    <category id="A08" name="Data Integrity Failures">
      - Insecure deserialization (pickle, yaml.load)
      - Unsigned updates/data
    </category>
    <category id="A09" name="Logging & Monitoring Failures">
      - Missing audit logs for sensitive ops
      - Log injection vulnerabilities
    </category>
    <category id="A10" name="SSRF">
      - URL fetching endpoints (Sheets import)
      - Internal service access via user input
    </category>
  </test_categories>

  <activation_conditions>
    - Before production deployment
    - After significant security changes
    - As part of regular security review cadence
  </activation_conditions>
</audit_manifest>
