# Security Audit Manifest

<audit_manifest>
  <audit_type>secure</audit_type>

  <purpose>
    Full-spectrum security audit (Red Team + Blue Team): identify vulnerabilities, misconfigurations, weak patterns, unsafe flows across backend, frontend, agents, infra, and database.
  </purpose>

  <scope>
    - API endpoints, auth flows, session handling
    - Database schema and migrations security
    - LLM interactions (prompt injection surfaces)
    - External services (Supabase, n8n, etc.)
    - Infra/Docker/CI secrets
    - Multi-agent system trust boundaries
    - Frontend XSS and token leakage
  </scope>

  <constraints>
    - Follow CLAUDE.md, GOVERNANCE, CONTEXT_BOUNDARY, MODEL_GUIDANCE, TASK_PATTERNS
    - Breaking changes allowed
    - Keep outputs concise (bullets)
    - Use minimal diffs, shallow reasoning
    - No full-file dumps unless essential
  </constraints>

  <required_inputs>
    - API route definitions and auth middleware
    - Database schema and sensitive columns
    - LLM prompt templates and input handling
    - Agent orchestration and meeting flow logic
    - Frontend template rendering and session handling
    - Infra configs (Docker, CI, env files)
  </required_inputs>

  <expected_outputs>
    - Attack surface map (bullets)
    - Vulnerability list with category, vector, impact, likelihood
    - Fix Pack: high→medium→low priority remediations
    - Security test plan checklist
    - Minimal diff patches for critical fixes
    - Final report: security_audit_report.md
  </expected_outputs>

  <activation_conditions>
    - Before production deployment
    - After auth/session changes
    - After adding new API endpoints
    - Quarterly security review
  </activation_conditions>

  <run_pattern>
    1. Map security-relevant surfaces and trust boundaries
    2. Red Team analysis (offensive vulnerability scan)
    3. Blue Team analysis (defensive mitigations)
    4. Generate security test plan
    5. Apply high-priority code/infra changes
    6. Write report to /security_audit_report.md
  </run_pattern>
</audit_manifest>
