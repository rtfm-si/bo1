# Auth Penetration Testing Manifest

<audit_manifest>
  <audit_type>security-pentest</audit_type>

  <purpose>
    Manual penetration testing of authentication flows to identify vulnerabilities
    in session handling, CSRF protection, brute force prevention, and OAuth flows.
  </purpose>

  <scope>
    - Session fixation and hijacking
    - CSRF token validation
    - Brute force and rate limit bypass
    - OAuth state parameter validation
    - Token replay attacks
  </scope>

  <constraints>
    - Follow CLAUDE.md, GOVERNANCE, CONTEXT_BOUNDARY
    - Requires running local environment (`make up`)
    - Document all findings with reproduction steps
    - Remediate critical/high issues before marking complete
  </constraints>

  <required_inputs>
    - SuperTokens configuration
    - Auth middleware (session handling)
    - Rate limit middleware
    - OAuth flow implementation
    - Running dev environment
  </required_inputs>

  <expected_outputs>
    - Test case results (pass/fail)
    - Vulnerability findings with severity
    - Reproduction steps for each finding
    - Remediation recommendations
    - Final report: audits/reports/auth-pentest.report.md
  </expected_outputs>

  <test_categories>
    <category name="session">
      - Session fixation (pre-set session ID)
      - Session ID in URL parameters
      - Session transfer across users
      - Session regeneration on login
    </category>
    <category name="csrf">
      - POST without CSRF token
      - Cross-origin form submission
      - SameSite cookie enforcement
    </category>
    <category name="brute_force">
      - Rapid login attempts
      - X-Forwarded-For bypass
      - Password reset rate limiting
    </category>
    <category name="oauth">
      - OAuth callback without state
      - Token reuse/replay
      - redirect_uri manipulation
    </category>
  </test_categories>

  <activation_conditions>
    - After auth security audit
    - Before production deployment
    - After significant auth changes
  </activation_conditions>
</audit_manifest>
